{% extends "bootstrap/base.html" %}

{% block title %}Flask_Sqlachemy_RESTfulAPI_Codegen{% endblock %}

{% block styles %}
    {{ super() }}
    <link rel="stylesheet" href="../static/css/global.css">
    <link rel="stylesheet" href="../static/css/table.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script>
        $(function () {
            $("[data-toggle='tooltip']").tooltip();
        });
    </script>
    <script type="text/javascript" src="../static/js/table.js"></script>
    <script type="text/javascript">
        let data = []
    </script>
{% endblock %}

{% block content %}

    <div class="panel panel-primary">
        <div class="panel-heading">
            <h3 class="panel-title">Flask_Sqlachemy_RESTfulAPI_Codegen</h3>
        </div>
        <div class="panel-body">
            <h2> 数据表准备 </h2>
            选择用于生成代码的数据表，并为每张表进行相应的配置
        </div>

        <div class="panel-body">


            <div class="table-index">

                <div class="navbar navbar-default nav-table" role="navigation">
                    <ul class="nav nav-pills nav-stacked">
                        {% for item in data %}
                            <script type="text/javascript">
                                data.push("{{item}}")
                            </script>
                            <li onclick=setActive()><a id="{{ item.table }}" onclick=toTableInfo()>{{ item.table }}
                                {% if item.issave=='true' %}
                                    <span class="glyphicon glyphicon-cog" style="color:#0F9D24"></span>
                                {% else %}
                                    <span class="glyphicon glyphicon-cog"></span>
                                {% endif %}
                            </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>


            <div class="table-info">
                <div>
                    <h3 id="tableName">Table</h3>
                </div>
                <div>
                    <label><input type="checkbox" id="isBusinessKey" onclick=businessKey()>请选择是否存在业务主键</label>
                    <a class="tooltip-test" data-toggle="tooltip" data-html="true"
                       title="业务主键说明：比如order表中的OrderID一般被称为业务主键；业务主键尽量不采用自增的方式；"><span
                            class="glyphicon glyphicon-question-sign"></span></a>
                </div>

                <div id="businessKeyRule">
                    <label>业务主键字段选择</label>
                    <select class="form-control" id="selectBusinessKey" onclick="selectBusinessKeyRule()">
                    </select>
                    <label>业务主键生成规则</label>
                    <a class="tooltip-test" data-toggle="tooltip" data-html="true"
                       title="业务主键生成规则使用已定义的规则：‘create_random_id’,‘create_hashlib_id’,‘create_uid’.以及无生成规则，默认为无生成规则"><span
                            class="glyphicon glyphicon-question-sign"></span></a>

                    <select class="form-control" id="textRule">
                    </select>
                </div>
                <div>

                    <label><input type="checkbox" id="isDeleted">数据记录是否逻辑删除</label>
                    <a class="tooltip-test" data-toggle="tooltip" data-html="true"
                       title="逻辑删除方式<br/>注:即表中必须包含IsDelete的标识删除字段"><span
                            class="glyphicon glyphicon-question-sign"></span></a>

                </div>
                <div>
                    <label>请选择需要加密存储的字段</label>
                    <a class="tooltip-test" data-toggle="tooltip" data-html="true"
                       title="加密配置:<br/>RSA公私钥请在config/security.conf中配置<br/>注：仅允许勾选类型为字符串的字段进行加密"><span
                            class="glyphicon glyphicon-question-sign"></span></a>
                    <div class="navbar navbar-default nav-field" role="navigation">
                        <ul class="nav nav-pills nav-stacked" id="filed">
                        </ul>
                    </div>
                </div>

                <div class="btn-save">
                    <button type="button" class="btn btn-primary" onclick=saveTableInfo()>保存</button>
                    <button type="button" class="btn btn-danger" onclick=removeTableInfo()>清空</button>
                </div>
                <div class="alert alert-success alert-save" id="btn-save">保存成功！</div>
            </div>
        </div>

        <div class="panel-body btn-body">
            <button type="button" class="btn btn-primary" onclick="window.history.back()">
                <span class="glyphicon glyphicon-arrow-left"></span>
            </button>
            <button type="submit" class="btn btn-primary btn-next" onclick="sendData()">下一步</button>
        </div>

        <div class="panel-footer">
        </div>
    </div>

{% endblock %}

